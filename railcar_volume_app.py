import streamlit as st

def interpolate_volume(data, height):
    keys = sorted(data.keys())
    if height in data:
        return data[height]
    elif height < keys[0] or height > keys[-1]:
        return None
    else:
        for i in range(len(keys) - 1):
            if keys[i] < height < keys[i + 1]:
                h1, h2 = keys[i], keys[i + 1]
                v1, v2 = data[h1], data[h2]
                return v1 + (v2 - v1) * ((height - h1) / (h2 - h1))

def convert_height_to_inches(value, unit):
    return value / 2.54 if unit == "cm" else value

def convert_volume(volume, unit):
    return volume * 3.78541 if unit == "litres" else volume

# ======================
# FULL DATASETS - SKSX117122
# ======================
sksx117122_data = {
    0.00: 0, 0.25: 23, 0.50: 47, 0.75: 72, 1.00: 98, 1.25: 125, 1.50: 153, 1.75: 182, 2.00: 212,
    2.25: 243, 2.50: 275, 2.75: 308, 3.00: 342, 3.25: 377, 3.50: 413, 3.75: 450, 4.00: 488,
    4.25: 526, 4.50: 565, 4.75: 605, 5.00: 646, 5.25: 688, 5.50: 730, 5.75: 773, 6.00: 817,
    6.25: 861, 6.50: 906, 6.75: 951, 7.00: 997, 7.25: 1043, 7.50: 1089, 7.75: 1136, 8.00: 1183,
    8.25: 1231, 8.50: 1279, 8.75: 1327, 9.00: 1376, 9.25: 1425, 9.50: 1474, 9.75: 1523, 10.00: 1573,
    10.25: 1623, 10.50: 1673, 10.75: 1723, 11.00: 1773, 11.25: 1823, 11.50: 1874, 11.75: 1924, 12.00: 1974,
    12.25: 2025, 12.50: 2075, 12.75: 2125, 13.00: 2176, 13.25: 2226, 13.50: 2276, 13.75: 2326, 14.00: 2376,
    14.25: 2425, 14.50: 2475, 14.75: 2525, 15.00: 2575, 15.25: 2625, 15.50: 2675, 15.75: 2724, 16.00: 2774,
    16.25: 2824, 16.50: 2873, 16.75: 2923, 17.00: 2972, 17.25: 3022, 17.50: 3071, 17.75: 3120, 18.00: 3170,
    18.25: 3219, 18.50: 3268, 18.75: 3317, 19.00: 3366, 19.25: 3415, 19.50: 3464, 19.75: 3513, 20.00: 3562,
    20.25: 3610, 20.50: 3659, 20.75: 3707, 21.00: 3756, 21.25: 3804, 21.50: 3852, 21.75: 3900, 22.00: 3948,
    22.25: 3996, 22.50: 4044, 22.75: 4091, 23.00: 4139, 23.25: 4186, 23.50: 4234, 23.75: 4281, 24.00: 4328,
    24.25: 4375, 24.50: 4422, 24.75: 4469, 25.00: 4516, 25.25: 4563, 25.50: 4610, 25.75: 4656, 26.00: 4703,
    26.25: 4749, 26.50: 4795, 26.75: 4841, 27.00: 4887, 27.25: 4933, 27.50: 4979, 27.75: 5025, 28.00: 5070,
    28.25: 5116, 28.50: 5161, 28.75: 5206, 29.00: 5251, 29.25: 5296, 29.50: 5341, 29.75: 5386, 30.00: 5431,
    30.25: 5475, 30.50: 5520, 30.75: 5564, 31.00: 5608, 31.25: 5652, 31.50: 5696, 31.75: 5740, 32.00: 5784,
    32.25: 5828, 32.50: 5872, 32.75: 5916, 33.00: 5960, 33.25: 6003, 33.50: 6047, 33.75: 6090, 34.00: 6133,
    34.25: 6177, 34.50: 6220, 34.75: 6263, 35.00: 6306, 35.25: 6349, 35.50: 6392, 35.75: 6435, 36.00: 6478,
    36.25: 6521, 36.50: 6564, 36.75: 6607, 37.00: 6650, 37.25: 6692, 37.50: 6735, 37.75: 6777, 38.00: 6820,
    38.25: 6862, 38.50: 6904, 38.75: 6946, 39.00: 6988, 39.25: 7030, 39.50: 7072, 39.75: 7114, 40.00: 7156,
    40.25: 7198, 40.50: 7240, 40.75: 7282, 41.00: 7323, 41.25: 7365, 41.50: 7406, 41.75: 7448, 42.00: 7489,
    42.25: 7531, 42.50: 7572, 42.75: 7613, 43.00: 7654, 43.25: 7695, 43.50: 7736, 43.75: 7777, 44.00: 7818,
    44.25: 7859, 44.50: 7900, 44.75: 7941, 45.00: 7982, 45.25: 8023, 45.50: 8063, 45.75: 8104, 46.00: 8144,
    46.25: 8185, 46.50: 8225, 46.75: 8265, 47.00: 8305, 47.25: 8345, 47.50: 8385, 47.75: 8425, 48.00: 8465,
    48.25: 8505, 48.50: 8545, 48.75: 8585, 49.00: 8624, 49.25: 8664, 49.50: 8703, 49.75: 8743, 50.00: 8782,
    50.25: 8821, 50.50: 8860, 50.75: 8899, 51.00: 8938, 51.25: 8977, 51.50: 9016, 51.75: 9055, 52.00: 9093,
    52.25: 9132, 52.50: 9170, 52.75: 9209, 53.00: 9247, 53.25: 9285, 53.50: 9323, 53.75: 9361, 54.00: 9399,
    54.25: 9437, 54.50: 9475, 54.75: 9513, 55.00: 9550, 55.25: 9588, 55.50: 9625, 55.75: 9663, 56.00: 9700,
    56.25: 9737, 56.50: 9774, 56.75: 9811, 57.00: 9848, 57.25: 9885, 57.50: 9922, 57.75: 9958, 58.00: 9995,
    58.25: 10031, 58.50: 10068, 58.75: 10104, 59.00: 10140, 59.25: 10176, 59.50: 10212, 59.75: 10248, 60.00: 10284,
    60.25: 10319, 60.50: 10355, 60.75: 10390, 61.00: 10426, 61.25: 10461, 61.50: 10496, 61.75: 10531, 62.00: 10566,
    62.25: 10601, 62.50: 10636, 62.75: 10671, 63.00: 10706, 63.25: 10741, 63.50: 10775, 63.75: 10810, 64.00: 10844,
    64.25: 10879, 64.50: 10913, 64.75: 10947, 65.00: 10981, 65.25: 11015, 65.50: 11049, 65.75: 11083, 66.00: 11117,
    66.25: 11150, 66.50: 11184, 66.75: 11217, 67.00: 11251, 67.25: 11284, 67.50: 11317, 67.75: 11350, 68.00: 11383,
    68.25: 11416, 68.50: 11449, 68.75: 11482, 69.00: 11515, 69.25: 11548, 69.50: 11580, 69.75: 11613, 70.00: 11645,
    70.25: 11678, 70.50: 11710, 70.75: 11742, 71.00: 11774, 71.25: 11806, 71.50: 11838, 71.75: 11870, 72.00: 11902,
    72.25: 11934, 72.50: 11965, 72.75: 11997, 73.00: 12028, 73.25: 12060, 73.50: 12091, 73.75: 12122, 74.00: 12153,
    74.25: 12184, 74.50: 12215, 74.75: 12246, 75.00: 12277, 75.25: 12308, 75.50: 12338, 75.75: 12369, 76.00: 12399,
    76.25: 12430, 76.50: 12460, 76.75: 12490, 77.00: 12520, 77.25: 12550, 77.50: 12580, 77.75: 12610, 78.00: 12640,
    78.25: 12670, 78.50: 12699, 78.75: 12729, 79.00: 12759, 79.25: 12788, 79.50: 12818, 79.75: 12847, 80.00: 12876,
    80.25: 12905, 80.50: 12934, 80.75: 12963, 81.00: 12992, 81.25: 13021, 81.50: 13050, 81.75: 13078, 82.00: 13107,
    82.25: 13135, 82.50: 13164, 82.75: 13192, 83.00: 13220, 83.25: 13248, 83.50: 13276, 83.75: 13304, 84.00: 13332,
    84.25: 13360, 84.50: 13387, 84.75: 13415, 85.00: 13442, 85.25: 13470, 85.50: 13497, 85.75: 13524, 86.00: 13551,
    86.25: 13578, 86.50: 13605, 86.75: 13632, 87.00: 13658, 87.25: 13685, 87.50: 13711, 87.75: 13738, 88.00: 13764,
    88.25: 13790, 88.50: 13816, 88.75: 13842, 89.00: 13868, 89.25: 13894, 89.50: 13920, 89.75: 13946, 90.00: 13971,
    90.25: 13997, 90.50: 14022, 90.75: 14048, 91.00: 14073, 91.25: 14098, 91.50: 14123, 91.75: 14148, 92.00: 14173,
    92.25: 14198, 92.50: 14223, 92.75: 14248, 93.00: 14273, 93.25: 14297, 93.50: 14322, 93.75: 14346, 94.00: 14370,
    94.25: 14395, 94.50: 14419, 94.75: 14443, 95.00: 14467, 95.25: 14491, 95.50: 14515, 95.75: 14539, 96.00: 14562,
    96.25: 14586, 96.50: 14609, 96.75: 14633, 97.00: 14656, 97.25: 14679, 97.50: 14702, 97.75: 14725, 98.00: 14748,
    98.25: 14771, 98.50: 14794, 98.75: 14817, 99.00: 14840, 99.25: 14862, 99.50: 14885, 99.75: 14907, 100.00: 14930,
    100.25: 14952, 100.50: 14974, 100.75: 14996, 101.00: 15018, 101.25: 15040, 101.50: 15062, 101.75: 15084, 102.00: 15106,
    102.25: 15128, 102.50: 15149, 102.75: 15171, 103.00: 15192, 103.25: 15214, 103.50: 15235, 103.75: 15256, 104.00: 15277,
    104.25: 15298, 104.50: 15319, 104.75: 15340, 105.00: 15361, 105.25: 15382, 105.50: 15403, 105.75: 15424, 106.00: 15444,
    106.25: 15465, 106.50: 15485, 106.75: 15506, 107.00: 15526, 107.25: 15546, 107.50: 15566, 107.75: 15586, 108.00: 15606,
    108.25: 15626, 108.50: 15646, 108.75: 15666, 109.00: 15686, 109.25: 15706, 109.50: 15725, 109.75: 15745, 110.00: 15764,
    110.25: 15784, 110.50: 15803, 110.75: 15822, 111.00: 15842, 111.25: 15861, 111.50: 15880, 111.75: 15899, 112.00: 15918,
    112.25: 15937, 112.50: 15956, 112.75: 15975, 113.00: 15994, 113.25: 16013, 113.50: 16032, 113.75: 16050, 114.00: 16069,
    114.25: 16087, 114.50: 16106, 114.75: 16124, 115.00: 16142, 115.25: 16160, 115.50: 16178, 115.75: 16196, 116.00: 16214,
    116.25: 16232, 116.50: 16250, 116.75: 16268, 117.00: 16286
}

# ======================
# FULL DATASETS - TCLX290169
# ======================
tclx290169_data = {
    0.00: 0, 0.25: 30, 0.50: 60, 0.75: 91, 1.00: 123, 1.25: 156, 1.50: 190, 1.75: 224, 2.00: 259,
    2.25: 295, 2.50: 331, 2.75: 368, 3.00: 405, 3.25: 444, 3.50: 482, 3.75: 522, 4.00: 562,
    4.25: 602, 4.50: 643, 4.75: 685, 5.00: 727, 5.25: 770, 5.50: 813, 5.75: 857, 6.00: 901,
    6.25: 946, 6.50: 991, 6.75: 1037, 7.00: 1083, 7.25: 1130, 7.50: 1177, 7.75: 1225, 8.00: 1273,
    8.25: 1321, 8.50: 1370, 8.75: 1420, 9.00: 1469, 9.25: 1520, 9.50: 1570, 9.75: 1621, 10.00: 1673,
    10.25: 1725, 10.50: 1777, 10.75: 1829, 11.00: 1882, 11.25: 1936, 11.50: 1990, 11.75: 2044, 12.00: 2098,
    12.25: 2153, 12.50: 2208, 12.75: 2264, 13.00: 2320, 13.25: 2376, 13.50: 2433, 13.75: 2490, 14.00: 2547,
    14.25: 2605, 14.50: 2663, 14.75: 2721, 15.00: 2780, 15.25: 2838, 15.50: 2898, 15.75: 2957, 16.00: 3017,
    16.25: 3077, 16.50: 3138, 16.75: 3198, 17.00: 3260, 17.25: 3321, 17.50: 3382, 17.75: 3444, 18.00: 3507,
    18.25: 3569, 18.50: 3632, 18.75: 3695, 19.00: 3758, 19.25: 3822, 19.50: 3885, 19.75: 3949, 20.00: 4014,
    20.25: 4078, 20.50: 4143, 20.75: 4208, 21.00: 4274, 21.25: 4339, 21.50: 4405, 21.75: 4471, 22.00: 4537,
    22.25: 4604, 22.50: 4671, 22.75: 4738, 23.00: 4805, 23.25: 4872, 23.50: 4940, 23.75: 5008, 24.00: 5076,
    24.25: 5144, 24.50: 5213, 24.75: 5281, 25.00: 5350, 25.25: 5419, 25.50: 5489, 25.75: 5558, 26.00: 5628,
    26.25: 5698, 26.50: 5768, 26.75: 5838, 27.00: 5909, 27.25: 5980, 27.50: 6051, 27.75: 6122, 28.00: 6193,
    28.25: 6264, 28.50: 6336, 28.75: 6408, 29.00: 6480, 29.25: 6552, 29.50: 6624, 29.75: 6697, 30.00: 6769,
    30.25: 6842, 30.50: 6915, 30.75: 6988, 31.00: 7061, 31.25: 7135, 31.50: 7208, 31.75: 7282, 32.00: 7356,
    32.25: 7430, 32.50: 7504, 32.75: 7579, 33.00: 7653, 33.25: 7728, 33.50: 7802, 33.75: 7877, 34.00: 7952,
    34.25: 8028, 34.50: 8103, 34.75: 8178, 35.00: 8254, 35.25: 8329, 35.50: 8405, 35.75: 8481, 36.00: 8557,
    36.25: 8633, 36.50: 8710, 36.75: 8786, 37.00: 8862, 37.25: 8939, 37.50: 9016, 37.75: 9093, 38.00: 9170,
    38.25: 9247, 38.50: 9324, 38.75: 9401, 39.00: 9478, 39.25: 9556, 39.50: 9633, 39.75: 9711, 40.00: 9789,
    40.25: 9866, 40.50: 9944, 40.75: 10022, 41.00: 10100, 41.25: 10178, 41.50: 10257, 41.75: 10335, 42.00: 10413,
    42.25: 10492, 42.50: 10570, 42.75: 10649, 43.00: 10728, 43.25: 10807, 43.50: 10885, 43.75: 10964, 44.00: 11043,
    44.25: 11122, 44.50: 11201, 44.75: 11281, 45.00: 11360, 45.25: 11439, 45.50: 11518, 45.75: 11598, 46.00: 11677,
    46.25: 11757, 46.50: 11836, 46.75: 11916, 47.00: 11996, 47.25: 12075, 47.50: 12155, 47.75: 12235, 48.00: 12315,
    48.25: 12395, 48.50: 12474, 48.75: 12554, 49.00: 12634, 49.25: 12714, 49.50: 12794, 49.75: 12874, 50.00: 12955,
    50.25: 13035, 50.50: 13115, 50.75: 13195, 51.00: 13275, 51.25: 13355, 51.50: 13436, 51.75: 13516, 52.00: 13596,
    52.25: 13676, 52.50: 13757, 52.75: 13837, 53.00: 13917, 53.25: 13998, 53.50: 14078, 53.75: 14158, 54.00: 14239,
    54.25: 14319, 54.50: 14399, 54.75: 14480, 55.00: 14560, 55.25: 14640, 55.50: 14721, 55.75: 14801, 56.00: 14881,
    56.25: 14962, 56.50: 15042, 56.75: 15122, 57.00: 15202, 57.25: 15283, 57.50: 15363, 57.75: 15443, 58.00: 15523,
    58.25: 15604, 58.50: 15684, 58.75: 15764, 59.00: 15844, 59.25: 15924, 59.50: 16004, 59.75: 16084, 60.00: 16164,
    60.25: 16244, 60.50: 16324, 60.75: 16404, 61.00: 16483, 61.25: 16563, 61.50: 16643, 61.75: 16723, 62.00: 16802,
    62.25: 16882, 62.50: 16961, 62.75: 17041, 63.00: 17120, 63.25: 17200, 63.50: 17279, 63.75: 17358, 64.00: 17438,
    64.25: 17517, 64.50: 17596, 64.75: 17675, 65.00: 17754, 65.25: 17833, 65.50: 17912, 65.75: 17990, 66.00: 18069,
    66.25: 18148, 66.50: 18226, 66.75: 18305, 67.00: 18383, 67.25: 18461, 67.50: 18540, 67.75: 18618, 68.00: 18696,
    68.25: 18774, 68.50: 18852, 68.75: 18929, 69.00: 19007, 69.25: 19085, 69.50: 19162, 69.75: 19240, 70.00: 19317,
    70.25: 19394, 70.50: 19471, 70.75: 19548, 71.00: 19625, 71.25: 19702, 71.50: 19779, 71.75: 19855, 72.00: 19932,
    72.25: 20008, 72.50: 20084, 72.75: 20161, 73.00: 20237, 73.25: 20313, 73.50: 20388, 73.75: 20464, 74.00: 20539,
    74.25: 20615, 74.50: 20690, 74.75: 20765, 75.00: 20840, 75.25: 20915, 75.50: 20990, 75.75: 21064, 76.00: 21139,
    76.25: 21213, 76.50: 21287, 76.75: 21361, 77.00: 21435, 77.25: 21509, 77.50: 21583, 77.75: 21656, 78.00: 21729,
    78.25: 21802, 78.50: 21875, 78.75: 21948, 79.00: 22021, 79.25: 22093, 79.50: 22165, 79.75: 22238, 80.00: 22309,
    80.25: 22381, 80.50: 22453, 80.75: 22524, 81.00: 22595, 81.25: 22667, 81.50: 22737, 81.75: 22808, 82.00: 22879,
    82.25: 22949, 82.50: 23019, 82.75: 23089, 83.00: 23159, 83.25: 23228, 83.50: 23298, 83.75: 23367, 84.00: 23436,
    84.25: 23504, 84.50: 23573, 84.75: 23641, 85.00: 23709, 85.25: 23777, 85.50: 23845, 85.75: 23912, 86.00: 23979,
    86.25: 24046, 86.50: 24113, 86.75: 24180, 87.00: 24246, 87.25: 24312, 87.50: 24378, 87.75: 24443, 88.00: 24509,
    88.25: 24574, 88.50: 24638, 88.75: 24703, 89.00: 24767, 89.25: 24831, 89.50: 24895, 89.75: 24959, 90.00: 25022,
    90.25: 25085, 90.50: 25148, 90.75: 25210, 91.00: 25272, 91.25: 25334, 91.50: 25396, 91.75: 25457, 92.00: 25518,
    92.25: 25579, 92.50: 25639, 92.75: 25700, 93.00: 25759, 93.25: 25819, 93.50: 25878, 93.75: 25937, 94.00: 25996,
    94.25: 26054, 94.50: 26112, 94.75: 26170, 95.00: 26227, 95.25: 26284, 95.50: 26341, 95.75: 26397, 96.00: 26453,
    96.25: 26509, 96.50: 26564, 96.75: 26619, 97.00: 26673, 97.25: 26728, 97.50: 26781, 97.75: 26835, 98.00: 26888,
    98.25: 26941, 98.50: 26993, 98.75: 27045, 99.00: 27096, 99.25: 27147, 99.50: 27198, 99.75: 27248, 100.00: 27298,
    100.25: 27348, 100.50: 27397, 100.75: 27445, 101.00: 27494, 101.25: 27541, 101.50: 27589, 101.75: 27635, 102.00: 27682,
    102.25: 27728, 102.50: 27774, 102.75: 27819, 103.00: 27864, 103.25: 27909, 103.50: 27953, 103.75: 27997, 104.00: 28041,
    104.25: 28084, 104.50: 28127, 104.75: 28169, 105.00: 28211, 105.25: 28253, 105.50: 28294, 105.75: 28334, 106.00: 28375,
    106.25: 28414, 106.50: 28454, 106.75: 28493, 107.00: 28531, 107.25: 28570, 107.50: 28608, 107.75: 28645, 108.00: 28682,
    108.25: 28719, 108.50: 28755, 108.75: 28791, 109.00: 28827, 109.25: 28862, 109.50: 28897, 109.75: 28931, 110.00: 28965,
    110.25: 28999, 110.50: 29032, 110.75: 29065, 111.00: 29098, 111.25: 29130, 111.50: 29162, 111.75: 29193, 112.00: 29225,
    112.25: 29255, 112.50: 29286, 112.75: 29316, 113.00: 29345, 113.25: 29375, 113.50: 29404, 113.75: 29432, 114.00: 29461,
    114.25: 29489, 114.50: 29517, 114.75: 29544, 115.00: 29571, 115.25: 29598, 115.50: 29625, 115.75: 29651, 116.00: 29677,
    116.25: 29703, 116.50: 29729, 116.75: 29754, 117.00: 29779
}

# Streamlit app
st.title("Railcar Tank Volume Calculator")

tank_options = {
    "SKSX117122": sksx117122_data,
    "TCLX290169": tclx290169_data
}

selected_tank = st.selectbox("Select Tank Model", options=list(tank_options.keys()))

height_unit = st.radio("Input height unit:", ("inches", "cm"))
output_unit = st.radio("Output volume unit:", ("gallons", "litres"))

input_height = st.number_input(f"Enter height in {height_unit}:", min_value=0.0, max_value=117.0, step=0.25, format="%.2f")

height_in_inches = convert_height_to_inches(input_height, height_unit)

data = tank_options[selected_tank]
volume_gallons = interpolate_volume(data, height_in_inches)

if volume_gallons is None:
    st.error("Height out of range for selected tank.")
else:
    if output_unit == "litres":
        volume = volume_gallons * 3.78541
    else:
        volume = volume_gallons
    st.write(f"Estimated volume at {input_height} {height_unit} is: {volume:.2f} {output_unit}")

