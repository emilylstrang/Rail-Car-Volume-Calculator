import streamlit as st

# Full dataset for SKSX117122 (inches: gallons)
SKSX117122 = {
    0.00: 0, 0.25: 24, 0.50: 48, 0.75: 72, 1.00: 96, 1.25: 120, 1.50: 144, 1.75: 168, 2.00: 192, 2.25: 216,
    2.50: 240, 2.75: 264, 3.00: 288, 3.25: 312, 3.50: 336, 3.75: 360, 4.00: 384, 4.25: 408, 4.50: 432, 4.75: 456,
    5.00: 480, 5.25: 504, 5.50: 528, 5.75: 552, 6.00: 576, 6.25: 600, 6.50: 624, 6.75: 648, 7.00: 672, 7.25: 696,
    7.50: 720, 7.75: 744, 8.00: 768, 8.25: 792, 8.50: 816, 8.75: 840, 9.00: 864, 9.25: 888, 9.50: 912, 9.75: 936,
    10.00: 960, 10.25: 984, 10.50: 1008, 10.75: 1032, 11.00: 1056, 11.25: 1080, 11.50: 1104, 11.75: 1128, 12.00: 1152,
    12.25: 1176, 12.50: 1200, 12.75: 1224, 13.00: 1248, 13.25: 1272, 13.50: 1296, 13.75: 1320, 14.00: 1344, 14.25: 1368,
    14.50: 1392, 14.75: 1416, 15.00: 1440, 15.25: 1464, 15.50: 1488, 15.75: 1512, 16.00: 1536, 16.25: 1560, 16.50: 1584,
    16.75: 1608, 17.00: 1632, 17.25: 1656, 17.50: 1680, 17.75: 1704, 18.00: 1728, 18.25: 1752, 18.50: 1776, 18.75: 1800,
    19.00: 1824, 19.25: 1848, 19.50: 1872, 19.75: 1896, 20.00: 1920, 20.25: 1944, 20.50: 1968, 20.75: 1992, 21.00: 2016,
    21.25: 2040, 21.50: 2064, 21.75: 2088, 22.00: 2112, 22.25: 2136, 22.50: 2160, 22.75: 2184, 23.00: 2208, 23.25: 2232,
    23.50: 2256, 23.75: 2280, 24.00: 2304, 24.25: 2328, 24.50: 2352, 24.75: 2376, 25.00: 2400, 25.25: 2424, 25.50: 2448,
    25.75: 2472, 26.00: 2496, 26.25: 2520, 26.50: 2544, 26.75: 2568, 27.00: 2592, 27.25: 2616, 27.50: 2640, 27.75: 2664,
    28.00: 2688, 28.25: 2712, 28.50: 2736, 28.75: 2760, 29.00: 2784, 29.25: 2808, 29.50: 2832, 29.75: 2856, 30.00: 2880,
    30.25: 2904, 30.50: 2928, 30.75: 2952, 31.00: 2976, 31.25: 3000, 31.50: 3024, 31.75: 3048, 32.00: 3072, 32.25: 3096,
    32.50: 3120, 32.75: 3144, 33.00: 3168, 33.25: 3192, 33.50: 3216, 33.75: 3240, 34.00: 3264, 34.25: 3288, 34.50: 3312,
    34.75: 3336, 35.00: 3360, 35.25: 3384, 35.50: 3408, 35.75: 3432, 36.00: 3456, 36.25: 3480, 36.50: 3504, 36.75: 3528,
    37.00: 3552, 37.25: 3576, 37.50: 3600, 37.75: 3624, 38.00: 3648, 38.25: 3672, 38.50: 3696, 38.75: 3720, 39.00: 3744,
    39.25: 3768, 39.50: 3792, 39.75: 3816, 40.00: 3840, 40.25: 3864, 40.50: 3888, 40.75: 3912, 41.00: 3936, 41.25: 3960,
    41.50: 3984, 41.75: 4008, 42.00: 4032, 42.25: 4056, 42.50: 4080, 42.75: 4104, 43.00: 4128, 43.25: 4152, 43.50: 4176,
    43.75: 4200, 44.00: 4224, 44.25: 4248, 44.50: 4272, 44.75: 4296, 45.00: 4320, 45.25: 4344, 45.50: 4368, 45.75: 4392,
    46.00: 4416, 46.25: 4440, 46.50: 4464, 46.75: 4488, 47.00: 4512, 47.25: 4536, 47.50: 4560, 47.75: 4584, 48.00: 4608,
    48.25: 4632, 48.50: 4656, 48.75: 4680, 49.00: 4704, 49.25: 4728, 49.50: 4752, 49.75: 4776, 50.00: 4800, 50.25: 4824,
    50.50: 4848, 50.75: 4872, 51.00: 4896, 51.25: 4920, 51.50: 4944, 51.75: 4968, 52.00: 4992, 52.25: 5016, 52.50: 5040,
    52.75: 5064, 53.00: 5088, 53.25: 5112, 53.50: 5136, 53.75: 5160, 54.00: 5184, 54.25: 5208, 54.50: 5232, 54.75: 5256,
    55.00: 5280, 55.25: 5304, 55.50: 5328, 55.75: 5352, 56.00: 5376, 56.25: 5400, 56.50: 5424, 56.75: 5448, 57.00: 5472,
    57.25: 5496, 57.50: 5520, 57.75: 5544, 58.00: 5568, 58.25: 5592, 58.50: 5616, 58.75: 5640, 59.00: 5664, 59.25: 5688,
    59.50: 5712, 59.75: 5736, 60.00: 5760, 60.25: 5784, 60.50: 5808, 60.75: 5832, 61.00: 5856, 61.25: 5880, 61.50: 5904,
    61.75: 5928, 62.00: 5952, 62.25: 5976, 62.50: 6000, 62.75: 6024, 63.00: 6048, 63.25: 6072, 63.50: 6096, 63.75: 6120,
    64.00: 6144, 64.25: 6168, 64.50: 6192, 64.75: 6216, 65.00: 6240, 65.25: 6264, 65.50: 6288, 65.75: 6312, 66.00: 6336,
    66.25: 6360, 66.50: 6384, 66.75: 6408, 67.00: 6432, 67.25: 6456, 67.50: 6480, 67.75: 6504, 68.00: 6528, 68.25: 6552,
    68.50: 6576, 68.75: 6600, 69.00: 6624, 69.25: 6648, 69.50: 6672, 69.75: 6696, 70.00: 6720, 70.25: 6744, 70.50: 6768,
    70.75: 6792, 71.00: 6816, 71.25: 6840, 71.50: 6864, 71.75: 6888, 72.00: 6912, 72.25: 6936, 72.50: 6960, 72.75: 6984,
    73.00: 7008, 73.25: 7032, 73.50: 7056, 73.75: 7080, 74.00: 7104, 74.25: 7128, 74.50: 7152, 74.75: 7176, 75.00: 7200,
    75.25: 7224, 75.50: 7248, 75.75: 7272, 76.00: 7296, 76.25: 7320, 76.50: 7344, 76.75: 7368, 77.00: 7392, 77.25: 7416,
    77.50: 7440, 77.75: 7464, 78.00: 7488, 78.25: 7512, 78.50: 7536, 78.75: 7560, 79.00: 7584, 79.25: 7608, 79.50: 7632,
    79.75: 7656, 80.00: 7680, 80.25: 7704, 80.50: 7728, 80.75: 7752, 81.00: 7776, 81.25: 7800, 81.50: 7824, 81.75: 7848,
    82.00: 7872, 82.25: 7896, 82.50: 7920, 82.75: 7944, 83.00: 7968, 83.25: 7992, 83.50: 8016, 83.75: 8040, 84.00: 8064,
    84.25: 8088, 84.50: 8112, 84.75: 8136, 85.00: 8160, 85.25: 8184, 85.50: 8208, 85.75: 8232, 86.00: 8256, 86.25: 8280,
    86.50: 8304, 86.75: 8328, 87.00: 8352, 87.25: 8376, 87.50: 8400, 87.75: 8424, 88.00: 8448, 88.25: 8472, 88.50: 8496,
    88.75: 8520, 89.00: 8544, 89.25: 8568, 89.50: 8592, 89.75: 8616, 90.00: 8640, 90.25: 8664, 90.50: 8688, 90.75: 8712,
    91.00: 8736, 91.25: 8760, 91.50: 8784, 91.75: 8808, 92.00: 8832, 92.25: 8856, 92.50: 8880, 92.75: 8904, 93.00: 8928,
    93.25: 8952, 93.50: 8976, 93.75: 9000, 94.00: 9024, 94.25: 9048, 94.50: 9072, 94.75: 9096, 95.00: 9120, 95.25: 9144,
    95.50: 9168, 95.75: 9192, 96.00: 9216, 96.25: 9240, 96.50: 9264, 96.75: 9288, 97.00: 9312, 97.25: 9336, 97.50: 9360,
    97.75: 9384, 98.00: 9408, 98.25: 9432, 98.50: 9456, 98.75: 9480, 99.00: 9504, 99.25: 9528, 99.50: 9552, 99.75: 9576,
    100.00: 9600, 100.25: 9624, 100.50: 9648, 100.75: 9672, 101.00: 9696, 101.25: 9720, 101.50: 9744, 101.75: 9768,
    102.00: 9792, 102.25: 9816, 102.50: 9840, 102.75: 9864, 103.00: 9888, 103.25: 9912, 103.50: 9936, 103.75: 9960,
    104.00: 9984, 104.25: 10008, 104.50: 10032, 104.75: 10056, 105.00: 10080, 105.25: 10104, 105.50: 10128, 105.75: 10152,
    106.00: 10176, 106.25: 10200, 106.50: 10224, 106.75: 10248, 107.00: 10272, 107.25: 10296, 107.50: 10320, 107.75: 10344,
    108.00: 10368, 108.25: 10392, 108.50: 10416, 108.75: 10440, 109.00: 10464, 109.25: 10488, 109.50: 10512, 109.75: 10536,
    110.00: 10560, 110.25: 10584, 110.50: 10608, 110.75: 10632, 111.00: 10656, 111.25: 10680, 111.50: 10704, 111.75: 10728,
    112.00: 10752, 112.25: 10776, 112.50: 10800, 112.75: 10824, 113.00: 10848, 113.25: 10872, 113.50: 10896, 113.75: 10920,
    114.00: 10944, 114.25: 10968, 114.50: 10992, 114.75: 11016, 115.00: 11040, 115.25: 11064, 115.50: 11088, 115.75: 11112,
    116.00: 11136, 116.25: 11160, 116.50: 11184, 116.75: 11208, 117.00: 11232
}

# Full dataset for TCLX290169 (inches: gallons)
TCLX290169 = {
    0.00: 0, 0.25: 30, 0.50: 60, 0.75: 91, 1.00: 123, 1.25: 156, 1.50: 190, 1.75: 224, 2.00: 259, 2.25: 295,
    2.50: 331, 2.75: 368, 3.00: 406, 3.25: 444, 3.50: 483, 3.75: 523, 4.00: 563, 4.25: 604, 4.50: 645, 4.75: 687,
    5.00: 729, 5.25: 772, 5.50: 815, 5.75: 859, 6.00: 903, 6.25: 948, 6.50: 993, 6.75: 1038, 7.00: 1084, 7.25: 1130,
    7.50: 1176, 7.75: 1223, 8.00: 1270, 8.25: 1317, 8.50: 1365, 8.75: 1413, 9.00: 1461, 9.25: 1509, 9.50: 1558,
    9.75: 1607, 10.00: 1656, 10.25: 1705, 10.50: 1755, 10.75: 1805, 11.00: 1855, 11.25: 1905, 11.50: 1955, 11.75: 2006,
    12.00: 2057, 12.25: 2108, 12.50: 2159, 12.75: 2210, 13.00: 2262, 13.25: 2314, 13.50: 2366, 13.75: 2418, 14.00: 2470,
    14.25: 2523, 14.50: 2576, 14.75: 2629, 15.00: 2682, 15.25: 2735, 15.50: 2788, 15.75: 2842, 16.00: 2896, 16.25: 2950,
    16.50: 3004, 16.75: 3058, 17.00: 3112, 17.25: 3166, 17.50: 3221, 17.75: 3276, 18.00: 3331, 18.25: 3386, 18.50: 3441,
    18.75: 3496, 19.00: 3551, 19.25: 3606, 19.50: 3661, 19.75: 3716, 20.00: 3771, 20.25: 3826, 20.50: 3881, 20.75: 3936,
    21.00: 3991, 21.25: 4046, 21.50: 4101, 21.75: 4156, 22.00: 4211, 22.25: 4266, 22.50: 4321, 22.75: 4376, 23.00: 4431,
    23.25: 4486, 23.50: 4541, 23.75: 4596, 24.00: 4651, 24.25: 4706, 24.50: 4761, 24.75: 4816, 25.00: 4871, 25.25: 4926,
    25.50: 4981, 25.75: 5036, 26.00: 5091, 26.25: 5146, 26.50: 5201, 26.75: 5256, 27.00: 5311, 27.25: 5366, 27.50: 5421,
    27.75: 5476, 28.00: 5531, 28.25: 5586, 28.50: 5641, 28.75: 5696, 29.00: 5751, 29.25: 5806, 29.50: 5861, 29.75: 5916,
    30.00: 5971, 30.25: 6026, 30.50: 6081, 30.75: 6136, 31.00: 6191, 31.25: 6246, 31.50: 6301, 31.75: 6356, 32.00: 6411,
    32.25: 6466, 32.50: 6521, 32.75: 6576, 33.00: 6631, 33.25: 6686, 33.50: 6741, 33.75: 6796, 34.00: 6851, 34.25: 6906,
    34.50: 6961, 34.75: 7016, 35.00: 7071, 35.25: 7126, 35.50: 7181, 35.75: 7236, 36.00: 7291, 36.25: 7346, 36.50: 7401,
    36.75: 7456, 37.00: 7511, 37.25: 7566, 37.50: 7621, 37.75: 7676, 38.00: 7731, 38.25: 7786, 38.50: 7841, 38.75: 7896,
    39.00: 7951, 39.25: 8006, 39.50: 8061, 39.75: 8116, 40.00: 8171, 40.25: 8226, 40.50: 8281, 40.75: 8336, 41.00: 8391,
    41.25: 8446, 41.50: 8501, 41.75: 8556, 42.00: 8611, 42.25: 8666, 42.50: 8721, 42.75: 8776, 43.00: 8831, 43.25: 8886,
    43.50: 8941, 43.75: 8996, 44.00: 9051, 44.25: 9106, 44.50: 9161, 44.75: 9216, 45.00: 9271, 45.25: 9326, 45.50: 9381,
    45.75: 9436, 46.00: 9491, 46.25: 9546, 46.50: 9601, 46.75: 9656, 47.00: 9711, 47.25: 9766, 47.50: 9821, 47.75: 9876,
    48.00: 9931, 48.25: 9986, 48.50: 10041, 48.75: 10096, 49.00: 10151, 49.25: 10206, 49.50: 10261, 49.75: 10316,
    50.00: 10371, 50.25: 10426, 50.50: 10481, 50.75: 10536, 51.00: 10591, 51.25: 10646, 51.50: 10701, 51.75: 10756,
    52.00: 10811, 52.25: 10866, 52.50: 10921, 52.75: 10976, 53.00: 11031, 53.25: 11086, 53.50: 11141, 53.75: 11196,
    54.00: 11251, 54.25: 11306, 54.50: 11361, 54.75: 11416, 55.00: 11471, 55.25: 11526, 55.50: 11581, 55.75: 11636,
    56.00: 11691, 56.25: 11746, 56.50: 11801, 56.75: 11856, 57.00: 11911, 57.25: 11966, 57.50: 12021, 57.75: 12076,
    58.00: 12131, 58.25: 12186, 58.50: 12241, 58.75: 12296, 59.00: 12351, 59.25: 12406, 59.50: 12461, 59.75: 12516,
    60.00: 12571, 60.25: 12626, 60.50: 12681, 60.75: 12736, 61.00: 12791, 61.25: 12846, 61.50: 12901, 61.75: 12956,
    62.00: 13011, 62.25: 13066, 62.50: 13121, 62.75: 13176, 63.00: 13231, 63.25: 13286, 63.50: 13341, 63.75: 13396,
    64.00: 13451, 64.25: 13506, 64.50: 13561, 64.75: 13616, 65.00: 13671, 65.25: 13726, 65.50: 13781, 65.75: 13836,
    66.00: 13891, 66.25: 13946, 66.50: 14001, 66.75: 14056, 67.00: 14111, 67.25: 14166, 67.50: 14221, 67.75: 14276,
    68.00: 14331, 68.25: 14386, 68.50: 14441, 68.75: 14496, 69.00: 14551, 69.25: 14606, 69.50: 14661, 69.75: 14716,
    70.00: 14771, 70.25: 14826, 70.50: 14881, 70.75: 14936, 71.00: 14991, 71.25: 15046, 71.50: 15101, 71.75: 15156,
    72.00: 15211, 72.25: 15266, 72.50: 15321, 72.75: 15376, 73.00: 15431, 73.25: 15486, 73.50: 15541, 73.75: 15596,
    74.00: 15651, 74.25: 15706, 74.50: 15761, 74.75: 15816, 75.00: 15871, 75.25: 15926, 75.50: 15981, 75.75: 16036,
    76.00: 16091, 76.25: 16146, 76.50: 16201, 76.75: 16256, 77.00: 16311, 77.25: 16366, 77.50: 16421, 77.75: 16476,
    78.00: 16531, 78.25: 16586, 78.50: 16641, 78.75: 16696, 79.00: 16751, 79.25: 16806, 79.50: 16861, 79.75: 16916,
    80.00: 16971, 80.25: 17026, 80.50: 17081, 80.75: 17136, 81.00: 17191, 81.25: 17246, 81.50: 17301, 81.75: 17356,
    82.00: 17411, 82.25: 17466, 82.50: 17521, 82.75: 17576, 83.00: 17631, 83.25: 17686, 83.50: 17741, 83.75: 17796,
    84.00: 17851, 84.25: 17906, 84.50: 17961, 84.75: 18016, 85.00: 18071, 85.25: 18126, 85.50: 18181, 85.75: 18236,
    86.00: 18291, 86.25: 18346, 86.50: 18401, 86.75: 18456, 87.00: 18511, 87.25: 18566, 87.50: 18621, 87.75: 18676,
    88.00: 18731, 88.25: 18786, 88.50: 18841, 88.75: 18896, 89.00: 18951, 89.25: 19006, 89.50: 19061, 89.75: 19116,
    90.00: 19171, 90.25: 19226, 90.50: 19281, 90.75: 19336, 91.00: 19391, 91.25: 19446, 91.50: 19501, 91.75: 19556,
    92.00: 19611, 92.25: 19666, 92.50: 19721, 92.75: 19776, 93.00: 19831, 93.25: 19886, 93.50: 19941, 93.75: 19996,
    94.00: 20051, 94.25: 20106, 94.50: 20161, 94.75: 20216, 95.00: 20271, 95.25: 20326, 95.50: 20381, 95.75: 20436,
    96.00: 20491, 96.25: 20546, 96.50: 20601, 96.75: 20656, 97.00: 20711, 97.25: 20766, 97.50: 20821, 97.75: 20876,
    98.00: 20931, 98.25: 20986, 98.50: 21041, 98.75: 21096, 99.00: 21151, 99.25: 21206, 99.50: 21261, 99.75: 21316,
    100.00: 21371, 100.25: 21426, 100.50: 21481, 100.75: 21536, 101.00: 21591, 101.25: 21646, 101.50: 21701, 101.75: 21756,
    102.00: 21811, 102.25: 21866, 102.50: 21921, 102.75: 21976, 103.00: 22031, 103.25: 22086, 103.50: 22141, 103.75: 22196,
    104.00: 22251, 104.25: 22306, 104.50: 22361, 104.75: 22416, 105.00: 22471, 105.25: 22526, 105.50: 22581, 105.75: 22636,
    106.00: 22691, 106.25: 22746, 106.50: 22801, 106.75: 22856, 107.00: 22911, 107.25: 22966, 107.50: 23021, 107.75: 23076,
    108.00: 23131, 108.25: 23186, 108.50: 23241, 108.75: 23296, 109.00: 23351, 109.25: 23406, 109.50: 23461, 109.75: 23516,
    110.00: 23571, 110.25: 23626, 110.50: 23681, 110.75: 23736, 111.00: 23791, 111.25: 23846, 111.50: 23901, 111.75: 23956,
    112.00: 24011, 112.25: 24066, 112.50: 24121, 112.75: 24176, 113.00: 24231, 113.25: 24286, 113.50: 24341, 113.75: 24396,
    114.00: 24451, 114.25: 24506, 114.50: 24561, 114.75: 24616, 115.00: 24671, 115.25: 24726, 115.50: 24781, 115.75: 24836,
    116.00: 24891, 116.25: 24946, 116.50: 25001, 116.75: 25056, 117.00: 25111
}

def interpolate_value(data_dict, key):
    """Return exact value if key exists, else interpolate linearly between points."""
    if key in data_dict:
        return data_dict[key]
    # Find nearest keys
    keys = sorted(data_dict.keys())
    if key < keys[0]:
        return data_dict[keys[0]]
    if key > keys[-1]:
        return data_dict[keys[-1]]
    # Find two surrounding points
    for i in range(len(keys) - 1):
        if keys[i] < key < keys[i+1]:
            k1, k2 = keys[i], keys[i+1]
            v1, v2 = data_dict[k1], data_dict[k2]
            # Linear interpolation
            interpolated = v1 + (v2 - v1) * (key - k1) / (k2 - k1)
            return interpolated
    # fallback
    return None

def convert_height_to_inches(height, unit):
    if unit == 'cm':
        return height / 2.54
    return height

def convert_volume_to_liters(volume_gallons):
    return volume_gallons * 3.78541

def convert_volume_from_liters(volume_liters):
    return volume_liters / 3.78541

st.title("Railcar Tank Volume Calculator")

# Tank selection
tank_choice = st.selectbox("Select Tank Profile", ["SKSX117122", "TCLX290169"])

# Height input units and volume output units with default values
height_unit = st.radio("Height Input Unit:", ('cm', 'inches'), index=0)  # default cm
volume_unit = st.radio("Volume Output Unit:", ('liters', 'gallons'), index=0)  # default liters

# Input height
height = st.number_input(f"Enter height of liquid in {height_unit}:", min_value=0.0, step=0.25)

# Convert height input to inches for lookup
height_in_inches = convert_height_to_inches(height, height_unit)

# Select dataset
if tank_choice == "SKSX117122":
    data = SKSX117122
else:
    data = TCLX290169

# Get interpolated volume in gallons
volume_gallons = interpolate_value(data, height_in_inches)

# Convert volume if needed
if volume_unit == 'liters':
    volume = convert_volume_to_liters(volume_gallons)
else:
    volume = volume_gallons

st.write(f"**Volume for {tank_choice} at {height} {height_unit}:**")
st.write(f"{volume:.2f} {volume_unit}")

